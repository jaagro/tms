<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jaagro.tms.biz.mapper.MessageMapperExt">
    <select id="listMessageByCondtion" resultMap="BaseResultMap"
            parameterType="com.jaagro.tms.biz.entity.Message">
        select
        <include refid="Base_Column_List"/>
        from message
        where enabled=1
        and (to_user_id=#{toUserId} or from_user_type=0)
        and msg_type in(1,2)
        order by create_time desc
    </select>
    <select id="listMessageByCriteriaDto" resultMap="BaseResultMap"
            parameterType="com.jaagro.tms.api.dto.Message.ListMessageCriteriaDto">
        select
        <include refid="Base_Column_List"/>
        from message
        where enabled=1
        <if test="toUserId != null">
            and (to_user_id=#{toUserId} or from_user_type=0)
        </if>
        <if test="msgType != null">
            and msg_type=#{msgType}
        </if>
        <if test="type != null">
            and type=#{type}
        </if>
        <if test="msgStatus != null">
        and msg_status=#{msgStatus}
      </if>
        order by create_time desc
    </select>
</mapper>